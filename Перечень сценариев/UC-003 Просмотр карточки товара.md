## UC-003 Просмотр карточки товара

| Поле                | Значение                        |
|---------------------|---------------------------------|
| **ID**              | UC-003                          |
| **Название**        | Просмотр карточки товара        |
| **Требования**      | FR-104: Отображение полной информации о товаре; FR-105: Просмотр отзывов и рейтинга |
| **Элемент Бэклога** |                                 |
| **Сервис**          | product-service; review-service |
| **Статус**          | ЧЕРНОВИК                        |
| **Описание**        | Сценарий описывает процесс просмотра полной информации о товаре покупателем. Является продолжением пользовательского пути «Поиск и выбор товара».<br>Интегрируется с:<br>UC-001 Поиск товаров (входная точка)<br>UC-004 Добавление товара в корзину |
| **Участники**       | ROLE_CUSTOMER (Покупатель)      |
| **Триггер**         | Пользователь кликает на карточку товара в результатах поиска или в каталоге. |
| **Предусловия**     | 1. Пользователь находится на сайте/в мобильном приложении маркетплейса.<br>2. Существует товар с указанным идентификатором.<br>3. Сервисы `product-service` и `review-service` доступны.<br>4. Пользователь не обязан быть авторизован (просмотр доступен всем). |
| **Постусловия**     | - **Успешное завершение:** Отображена полная карточка товара со всей информацией.<br>- **Альтернативное завершение:** Отображено сообщение «Товар не найден».<br>- **Исключительное завершение:** Показано сообщение об ошибке; карточка не отображена. |
| **Успешный сценарий** | 1. Пользователь кликает на карточку товара в результатах поиска или каталоге. Система формирует запрос к `product-service`: GET /api/v1/products/{productId}<br>2. `product-service` возвращает HTTP 200 + JSON с полной информацией о товаре: название, описание, цена, артикул (SKU), производитель, характеристики, изображения, наличие на складе.<br>3. Система отображает карточку товара со следующими блоками:<br>   - Основная информация (название, цена, рейтинг)<br>   - Галерея изображений (основное + дополнительные)<br>   - Описание товара (развернутое)<br>   - Характеристики (таблица параметров)<br>   - Статус наличия и сроки доставки<br>4. Система одновременно отправляет запрос к `review-service`: GET /api/v1/reviews?productId={productId}&page=1&size=10<br>5. `review-service` возвращает HTTP 200 + JSON с отзывами и агрегированным рейтингом.<br>6. Система отображает блок отзывов:<br>   - Средний рейтинг (из 5 звёзд)<br>   - Распределение рейтингов (количество отзывов по звёздам)<br>   - Список последних отзывов (автор, дата, текст, оценка)<br>   - Кнопка «Показать все отзывы»<br>7. Пользователь просматривает информацию о товаре и может:<br>   - Добавить товар в корзину (переход к сценарию **UC-004**)<br>   - Написать отзыв (если авторизован)<br>   - Поделиться ссылкой на товар |
| **Альтернативный сценарий АС1** | После шага 2 успешного сценария — `product-service` вернул пустой результат или 404 статус.<br>Система отображает:<br> *«Товар не найден»* <br> *«Возможно, товар был удалён или временно недоступен»* <br> Предлагает кнопки: «Вернуться к поиску», «Перейти в каталог».<br>Пользователь остаётся на странице, но карточка товара не отображается. |
| **Альтернативный сценарий АС2** | После шага 5 успешного сценария — `review-service` вернул пустой массив отзывов.<br>Система отображает блок отзывов с сообщением:<br> *«У этого товара пока нет отзывов»* <br> *«Будьте первым, кто оставит отзыв!»* <br>Отображается средний рейтинг = 0, если отзывов нет.<br>Кнопка «Написать отзыв» доступна только для авторизованных пользователей. |
| **Сценарий исключений СИ1** | После шага 2 успешного сценария — `product-service` вернул HTTP 5xx / таймаут > 3с.<br>Система логирует ошибку (уровень ERROR) с traceID и идентификатором товара.<br>Отображает пользователю:<br> *«Не удалось загрузить информацию о товаре. Повторите попытку позже»* <br>Отображается кнопка: «Попробовать снова».<br>Пользователь остаётся на странице, но карточка товара не отображена. |
| **Сценарий исключений СИ2** | После шага 5 успешного сценария — `review-service` вернул ошибку.<br>Система логирует ошибку (уровень WARN) с traceID.<br>Отображает карточку товара без блока отзывов или с сообщением:<br> *«Отзывы временно недоступны»* <br>Основная информация о товаре отображается корректно. |
